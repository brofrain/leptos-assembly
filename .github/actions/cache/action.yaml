name: Cache

runs:
  using: composite
  steps:
    - uses: actions/checkout@v4

    - name: Cargo cache setup
      uses: actions/cache@v4
      with:
        path: |
          ~/.cargo/
          ~/.rustup/toolchains/
          .cargo/
          target/
        key: ${{ runner.os }}-cargo-${{ hashFiles('**/Cargo.lock') }}
        restore-keys: ${{ runner.os }}-cargo-

    - name: pnpm setup
      uses: pnpm/action-setup@v3

    - name: Node setup
      uses: actions/setup-node@v4
      with:
        node-version-file: ".nvmrc"
        cache: pnpm

    - name: Install Node dependencies
      shell: bash
      run: pnpm i --frozen-lockfile
